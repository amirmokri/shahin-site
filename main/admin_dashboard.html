{% extends 'base.html' %}
{% load static %}

{% block title %}پنل مدیریت - {{ site_settings.site_name }}{% endblock %}

{% block content %}
<!-- Admin Header -->
<section class="bg-gradient-to-br from-shahin-blue via-shahin-dark-blue to-gray-900 text-white py-12 relative overflow-hidden">
    <!-- Decorative Background -->
    <div class="absolute inset-0 opacity-10">
        <div class="absolute top-0 left-0 w-full h-full bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23FFD700" fill-opacity="0.1"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')]"></div>
    </div>
    
    <div class="container mx-auto px-4 relative z-10">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4 space-x-reverse">
                <div class="w-16 h-16 bg-gradient-to-r from-shahin-yellow to-shahin-gold rounded-full flex items-center justify-center shadow-shahin-lg">
                    <i class="fas fa-cogs text-gray-900 text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-shahin-yellow to-white bg-clip-text text-transparent font-vazir">
                        پنل مدیریت
                    </h1>
                    <p class="text-shahin-yellow/80 mt-2 text-lg">مدیریت محتوا و سرویس‌ها</p>
                </div>
            </div>
            <div class="flex items-center space-x-4 space-x-reverse">
                <div class="text-right">
                    <span class="text-shahin-yellow/90 text-lg">خوش آمدید</span>
                    <p class="text-white font-bold">{{ user.username }}</p>
                </div>
                <a href="{% url 'admin:logout' %}" class="group bg-gradient-to-r from-red-500 to-red-600 text-white px-6 py-3 rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-red-glow">
                    <i class="fas fa-sign-out-alt ml-2 group-hover:scale-110 transition-transform duration-300"></i>
                    خروج
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Dashboard Stats -->
<section class="py-16 bg-gradient-to-br from-gray-50 to-gray-100">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-shahin-yellow to-shahin-gold rounded-full mb-6">
                <i class="fas fa-chart-bar text-gray-900 text-2xl"></i>
            </div>
            <h2 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-shahin-blue to-shahin-light-blue bg-clip-text text-transparent font-vazir mb-4">
                آمار کلی
            </h2>
            <p class="text-gray-600 text-lg">نمای کلی از وضعیت سایت و محتوا</p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div class="bg-white rounded-2xl shadow-shahin-lg p-8 text-center group hover:shadow-shahin-xl transition-all duration-300 transform hover:-translate-y-2" data-aos="fade-up" data-aos-delay="100">
                <div class="w-16 h-16 bg-gradient-to-r from-shahin-blue to-shahin-light-blue rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                    <i class="fas fa-newspaper text-white text-2xl"></i>
                </div>
                <h3 class="text-4xl font-bold text-gray-800 mb-2">{{ lectures.count }}</h3>
                <p class="text-gray-600 text-lg">مقالات</p>
            </div>
            <div class="bg-white rounded-2xl shadow-shahin-lg p-8 text-center group hover:shadow-shahin-xl transition-all duration-300 transform hover:-translate-y-2" data-aos="fade-up" data-aos-delay="200">
                <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                    <i class="fas fa-tools text-white text-2xl"></i>
                </div>
                <h3 class="text-4xl font-bold text-gray-800 mb-2">{{ services.count }}</h3>
                <p class="text-gray-600 text-lg">سرویس‌ها</p>
            </div>
            <div class="bg-white rounded-2xl shadow-shahin-lg p-8 text-center group hover:shadow-shahin-xl transition-all duration-300 transform hover:-translate-y-2" data-aos="fade-up" data-aos-delay="300">
                <div class="w-16 h-16 bg-gradient-to-r from-shahin-yellow to-shahin-gold rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                    <i class="fas fa-envelope text-gray-900 text-2xl"></i>
                </div>
                <h3 class="text-4xl font-bold text-gray-800 mb-2">{{ contact_messages.count }}</h3>
                <p class="text-gray-600 text-lg">پیام‌ها</p>
            </div>
            <div class="bg-white rounded-2xl shadow-shahin-lg p-8 text-center group hover:shadow-shahin-xl transition-all duration-300 transform hover:-translate-y-2" data-aos="fade-up" data-aos-delay="400">
                <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                    <i class="fas fa-check-circle text-white text-2xl"></i>
                </div>
                <h3 class="text-4xl font-bold text-gray-800 mb-2">فعال</h3>
                <p class="text-gray-600 text-lg">وضعیت سایت</p>
            </div>
            <div class="bg-white rounded-2xl shadow-shahin-lg p-8 text-center group hover:shadow-shahin-xl transition-all duration-300 transform hover:-translate-y-2" data-aos="fade-up" data-aos-delay="500">
                <div class="w-16 h-16 bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                    <i class="fas fa-calendar-check text-gray-900 text-2xl"></i>
                </div>
                <h3 class="text-4xl font-bold text-gray-800 mb-2">{{ new_appointments_count }}</h3>
                <p class="text-gray-600 text-lg">درخواست رزرو جدید</p>
            </div>
        </div>
    </div>
</section>

<!-- Quick Actions -->
<section class="py-8">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Add New Content -->
            <div class="bg-white rounded-lg shadow-lg p-6" data-aos="fade-up" data-aos-delay="100">
                <h2 class="text-xl font-bold text-gray-800 mb-6">افزودن محتوای جدید</h2>
                <div class="space-y-4">
                    <a href="{% url 'admin:main_lecture_add' %}" class="block w-full bg-blue-600 text-white text-center py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-300">
                        افزودن مقاله جدید
                    </a>
                    <a href="{% url 'admin:main_service_add' %}" class="block w-full bg-green-600 text-white text-center py-3 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300">
                        افزودن سرویس جدید
                    </a>
                    <a href="{% url 'admin:main_sitesettings_change' 1 %}" class="block w-full bg-purple-600 text-white text-center py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors duration-300">
                        ویرایش تنظیمات سایت
                    </a>
                </div>
            </div>

            <!-- Recent Messages -->
            <div class="bg-white rounded-lg shadow-lg p-6" data-aos="fade-up" data-aos-delay="200">
                <h2 class="text-xl font-bold text-gray-800 mb-6">آخرین پیام‌ها</h2>
                <div class="space-y-4 max-h-64 overflow-y-auto">
                    {% for message in contact_messages %}
                    <div class="border border-gray-200 rounded-lg p-4 {% if not message.is_read %}bg-blue-50 border-blue-200{% endif %}">
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-medium text-gray-800">{{ message.name }}</h4>
                            <span class="text-sm text-gray-500">{{ message.created_at|date:"Y/m/d H:i" }}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">{{ message.message|truncatewords:15 }}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-500">{{ message.email }}</span>
                            <a href="{% url 'admin:main_contactmessage_change' message.id %}" class="text-blue-600 hover:text-blue-800 text-sm">
                                مشاهده کامل
                            </a>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-gray-500 text-center py-4">هیچ پیامی وجود ندارد</p>
                    {% endfor %}
                </div>
                <div class="mt-4">
                    <a href="{% url 'admin:main_contactmessage_changelist' %}" class="text-blue-600 hover:text-blue-800 text-sm">
                        مشاهده همه پیام‌ها →
                    </a>
                </div>
            </div>

            <!-- Recent Appointments -->
            <div class="bg-white rounded-lg shadow-lg p-6" data-aos="fade-up" data-aos-delay="250">
                <h2 class="text-xl font-bold text-gray-800 mb-6">آخرین درخواست‌های رزرو</h2>
                <div class="space-y-4 max-h-64 overflow-y-auto">
                    {% for appt in appointments %}
                    <div class="border border-gray-200 rounded-lg p-4 {% if not appt.is_processed %}bg-yellow-50 border-yellow-200{% endif %}">
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-medium text-gray-800">{{ appt.name }} - {{ appt.phone }}</h4>
                            <span class="text-sm text-gray-500">{{ appt.created_at|date:"Y/m/d H:i" }}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">{{ appt.service }}{% if appt.car_model %} • {{ appt.car_model }}{% endif %}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-500">تاریخ پیشنهادی: {{ appt.preferred_date|default:"-" }}</span>
                            <a href="{% url 'admin:main_appointmentrequest_change' appt.id %}" class="text-blue-600 hover:text-blue-800 text-sm">مشاهده</a>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-gray-500 text-center py-4">هیچ درخواستی وجود ندارد</p>
                    {% endfor %}
                </div>
                <div class="mt-4">
                    <a href="{% url 'admin:main_appointmentrequest_changelist' %}" class="text-blue-600 hover:text-blue-800 text-sm">مشاهده همه درخواست‌ها →</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Content Management -->
<section class="py-8 bg-gray-100">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Lectures Management -->
            <div class="bg-white rounded-lg shadow-lg p-6" data-aos="fade-up" data-aos-delay="100">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">مدیریت مقالات</h2>
                    <a href="{% url 'admin:main_lecture_changelist' %}" class="text-blue-600 hover:text-blue-800 text-sm">
                        مشاهده همه →
                    </a>
                </div>
                <div class="space-y-3 max-h-64 overflow-y-auto">
                    {% for lecture in lectures|slice:":5" %}
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex-1">
                            <h4 class="font-medium text-gray-800">{{ lecture.title }}</h4>
                            <p class="text-sm text-gray-500">{{ lecture.created_at|date:"Y/m/d" }}</p>
                        </div>
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <span class="px-2 py-1 text-xs rounded-full {% if lecture.is_published %}bg-green-100 text-green-800{% else %}bg-red-100 text-red-800{% endif %}">
                                {% if lecture.is_published %}منتشر شده{% else %}پیش‌نویس{% endif %}
                            </span>
                            <a href="{% url 'admin:main_lecture_change' lecture.id %}" class="text-blue-600 hover:text-blue-800 text-sm">
                                ویرایش
                            </a>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-gray-500 text-center py-4">هیچ مقاله‌ای وجود ندارد</p>
                    {% endfor %}
                </div>
            </div>

            <!-- Services Management -->
            <div class="bg-white rounded-lg shadow-lg p-6" data-aos="fade-up" data-aos-delay="200">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">مدیریت سرویس‌ها</h2>
                    <a href="{% url 'admin:main_service_changelist' %}" class="text-blue-600 hover:text-blue-800 text-sm">
                        مشاهده همه →
                    </a>
                </div>
                <div class="space-y-3 max-h-64 overflow-y-auto">
                    {% for service in services|slice:":5" %}
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex-1">
                            <h4 class="font-medium text-gray-800">{{ service.name }}</h4>
                            <p class="text-sm text-gray-500">{{ service.created_at|date:"Y/m/d" }}</p>
                        </div>
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <span class="px-2 py-1 text-xs rounded-full {% if service.is_published %}bg-green-100 text-green-800{% else %}bg-red-100 text-red-800{% endif %}">
                                {% if service.is_published %}منتشر شده{% else %}پیش‌نویس{% endif %}
                            </span>
                            <a href="{% url 'admin:main_service_change' service.id %}" class="text-blue-600 hover:text-blue-800 text-sm">
                                ویرایش
                            </a>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-gray-500 text-center py-4">هیچ سرویسی وجود ندارد</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- System Information -->
<section class="py-16">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-shahin-yellow to-shahin-gold rounded-full mb-6">
                <i class="fas fa-server text-gray-900 text-2xl"></i>
            </div>
            <h2 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-shahin-blue to-shahin-light-blue bg-clip-text text-transparent font-vazir mb-4">
                اطلاعات سیستم
            </h2>
            <p class="text-gray-600 text-lg">فناوری‌های استفاده شده در پلتفرم</p>
        </div>
        
        <div class="bg-white rounded-2xl shadow-shahin-lg p-8" data-aos="fade-up">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center group">
                    <div class="w-20 h-20 bg-gradient-to-r from-shahin-blue to-shahin-light-blue rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                        <i class="fab fa-python text-white text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Django</h3>
                    <p class="text-gray-600">فریمورک وب قدرتمند</p>
                </div>
                <div class="text-center group">
                    <div class="w-20 h-20 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-database text-white text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">MySQL</h3>
                    <p class="text-gray-600">پایگاه داده قابل اعتماد</p>
                </div>
                <div class="text-center group">
                    <div class="w-20 h-20 bg-gradient-to-r from-shahin-yellow to-shahin-gold rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-code text-gray-900 text-3xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">DRF</h3>
                    <p class="text-gray-600">API Framework پیشرفته</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Pre-Footer Call to Action -->
<section class="py-16 bg-gradient-to-br from-gray-100 to-gray-200">
    <div class="container mx-auto px-4">
        <div class="text-center">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-shahin-yellow to-shahin-gold rounded-full mb-6">
                <i class="fas fa-rocket text-gray-900 text-2xl"></i>
            </div>
            <h2 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-shahin-blue to-shahin-light-blue bg-clip-text text-transparent font-vazir mb-4">
                آماده برای مدیریت
            </h2>
            <p class="text-gray-600 text-lg mb-8 max-w-2xl mx-auto">
                پنل مدیریت شما آماده است. می‌توانید محتوا، سرویس‌ها و تنظیمات سایت را به راحتی مدیریت کنید.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="{% url 'admin:main_lecture_add' %}" class="group inline-flex items-center px-8 py-4 bg-gradient-to-r from-shahin-blue to-shahin-light-blue text-white font-bold rounded-xl hover:from-shahin-light-blue hover:to-shahin-blue transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-blue-glow">
                    <i class="fas fa-plus ml-2 group-hover:scale-110 transition-transform duration-300"></i>
                    افزودن مقاله جدید
                </a>
                <a href="{% url 'admin:main_service_add' %}" class="group inline-flex items-center px-8 py-4 bg-gradient-to-r from-shahin-yellow to-shahin-gold text-gray-900 font-bold rounded-xl hover:from-shahin-gold hover:to-shahin-yellow transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-yellow-glow">
                    <i class="fas fa-tools ml-2 group-hover:scale-110 transition-transform duration-300"></i>
                    افزودن سرویس جدید
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Auto-refresh dashboard data every 30 seconds
setInterval(() => {
    // You can add AJAX calls here to refresh data
    console.log('Dashboard data refresh...');
}, 30000);

// Add confirmation for delete actions
document.addEventListener('DOMContentLoaded', function() {
    const deleteLinks = document.querySelectorAll('a[href*="delete"]');
    deleteLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            if (!confirm('آیا مطمئن هستید که می‌خواهید این آیتم را حذف کنید؟')) {
                e.preventDefault();
            }
        });
    });
});

// Add loading states for form submissions
document.addEventListener('DOMContentLoaded', function() {
    const forms = document.querySelectorAll('form');
    forms.forEach(form => {
        form.addEventListener('submit', function() {
            const submitBtn = form.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'در حال پردازش...';
            }
        });
    });
});
</script>
{% endblock %}
